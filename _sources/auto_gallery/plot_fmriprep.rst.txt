
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_gallery/plot_fmriprep.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_gallery_plot_fmriprep.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_gallery_plot_fmriprep.py:


fmriprep pre-processing use case
================================

Credit: A Grigis

Example on how to run thefmriprep pre-processing using the brainprep
Singularity container.

.. GENERATED FROM PYTHON SOURCE LINES 11-17

.. code-block:: default

    # sphinx_gallery_thumbnail_path = '_static/carousel/fmriprep.png'

    import os
    import subprocess
    from brainrise.datasets import MRIToyDataset








.. GENERATED FROM PYTHON SOURCE LINES 18-19

Please tune these parameters.

.. GENERATED FROM PYTHON SOURCE LINES 19-45

.. code-block:: default


    DATADIR = "/tmp/brainprep-data"
    OUTDIR = "/tmp/brainprep-out"
    WORKDIR = "/tmp/brainprep-out/work"
    HOMEDIR = "/tmp/brainprep-home"
    SCRIPT = "fmriprep"
    SIMG = "/volatile/nsap/brainprep/fmriprep/brainprep-fmriprep-latest.simg"

    for path in (DATADIR, OUTDIR, HOMEDIR, WORKDIR):
        if not os.path.isdir(path):
            os.mkdir(path)
    dataset = MRIToyDataset(root=DATADIR)
    t1w_file = os.path.join(DATADIR, os.path.basename(MRIToyDataset.t1w_url))
    func_file = t1w_file
    desc_file = t1w_file
    cmd = ["singularity", "run", "--bind", "{0}:/data".format(DATADIR),
           "--bind", "{0}:/out".format(OUTDIR), "--home", HOMEDIR, "--cleanenv",
           SIMG,
           "brainprep", SCRIPT,
           t1w_file.replace(DATADIR, "/data"),
           func_file.replace(DATADIR, "/data"),
           desc_file.replace(DATADIR, "/data"),
           "sub-error",
           "--outdir", "/out",
           "--workdir", "/out/work"]








.. GENERATED FROM PYTHON SOURCE LINES 46-47

You can now execute this command.

.. GENERATED FROM PYTHON SOURCE LINES 47-50

.. code-block:: default


    print(" ".join(cmd))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    singularity run --bind /tmp/brainprep-data:/data --bind /tmp/brainprep-out:/out --home /tmp/brainprep-home --cleanenv /volatile/nsap/brainprep/fmriprep/brainprep-fmriprep-latest.simg brainprep fmriprep /data/T1W.nii.gz /data/T1W.nii.gz /data/T1W.nii.gz sub-error --outdir /out --workdir /out/work





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.310 seconds)

**Estimated memory usage:**  8 MB


.. _sphx_glr_download_auto_gallery_plot_fmriprep.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_fmriprep.py <plot_fmriprep.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_fmriprep.ipynb <plot_fmriprep.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
